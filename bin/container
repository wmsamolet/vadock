#!/bin/bash

function info {
  echo "--------------------------------------------------------------------------------------"
  echo "-"
  echo -e "-  $1"
  echo "-"
  echo "--------------------------------------------------------------------------------------"
  echo
}

echo

#---------------------------------------------------------------------------------------------#

PROJECT_NAME="new-project"

if [ ! -z "$1" ]
  then PROJECT_NAME=$1
else
    read -p "Enter project name [default: new-project]: " INPUT
    echo
fi

if [ ! -z ${INPUT} ]
then
    PROJECT_NAME=${INPUT}
fi

#---------------------------------------------------------------------------------------------#

DOCKER_COMPOSE_NAME="php"

if [ ! -z "$2" ]
  then DOCKER_COMPOSE_NAME=$2
else
    read -p "Enter docker container name [${DOCKER_COMPOSE_NAME}]: " INPUT
    echo
fi

if [ ! -z ${INPUT} ]
then
    DOCKER_COMPOSE_NAME=${INPUT}
fi

#---------------------------------------------------------------------------------------------#

DOCKER_CONTAINER_COMMAND="/bin/bash"

if [ ! -z "$3" ]
  then DOCKER_CONTAINER_COMMAND=$3
else
    read -p "Enter docker container command [${DOCKER_CONTAINER_COMMAND}]: " INPUT
    echo
fi

if [ ! -z ${INPUT} ]
then
    DOCKER_CONTAINER_COMMAND=${INPUT}
fi

#---------------------------------------------------------------------------------------------#

VDK_PATH="$( cd "$(dirname "$0")"/../ ; pwd -P )"

PROJECT_PATH=${VDK_PATH}/projects/${PROJECT_NAME}

DOCKER_BIN_PATH=${VDK_PATH}/docker/bin

source ${PROJECT_PATH}/.env

#---------------------------------------------------------------------------------------------#

(cd ${PROJECT_PATH} && env VDK_PROJECT_NAME=${PROJECT_NAME} docker exec -it ${VDK_PREFIX}${DOCKER_COMPOSE_NAME} ${DOCKER_CONTAINER_COMMAND})

echo