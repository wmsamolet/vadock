#!/bin/bash

function info {
  echo "----------------------------------------------------------------------------"
  echo " "
  echo "--> $1"
  echo " "
  echo "----------------------------------------------------------------------------"
}

#---------------------------------------------------------------------------------#

COMPOSE_PROJECT="default"

if [ ! -z "$1" ]
  then COMPOSE_PROJECT=$1
  else
    read -p "COMPOSE_PROJECT [example: default]: " INPUT_COMPOSE_PROJECT
fi

if [ ! -z ${INPUT_COMPOSE_PROJECT} ]
then
    COMPOSE_PROJECT=${INPUT_COMPOSE_PROJECT}
fi

echo

#---------------------------------------------------------------------------------#

COMPOSE_FILE="php"

if [ ! -z "$2" ]
  then COMPOSE_FILE=$2
  else
    read -p "COMPOSE_FILE [example: php]: " INPUT_COMPOSE_FILE
fi

if [ ! -z ${INPUT_COMPOSE_FILE} ]
then
    COMPOSE_FILE=${INPUT_COMPOSE_FILE}
fi

echo

#---------------------------------------------------------------------------------#

VDK_PATH="$( cd "$(dirname "$0")"/../../ ; pwd -P )"
COMPOSE_PROJECT_PATH=${VDK_PATH}/config/${COMPOSE_PROJECT}

#---------------------------------------------------------------------------------#

info "DOCKER INIT (UP + BUILD) project \"${COMPOSE_PROJECT}\" compose file \"${COMPOSE_FILE}.yml\""

(cd ${COMPOSE_PROJECT_PATH} && docker-compose -p ${COMPOSE_PROJECT} -f ${COMPOSE_PROJECT_PATH}/compose/${COMPOSE_FILE}.yml up -d --build --force-recreate)
